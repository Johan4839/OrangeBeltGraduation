First things first: refactor readability
So done that, now to extract seperate behaviours into own method. Thinking about where to go, probably switch statement first and see from there